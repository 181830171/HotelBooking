# 互联网酒店预定系统软件体系结构文档

| 修改人员 | 日期 | 修改原因 | 版本号 |
| :---: | --- | --- | --- |
| 汪乐琪 | 2020.04.21 | 引言，产品概述，逻辑视图，组合视图 | v1.0 |
| 汪乐琪 | 2020.04.24 | 将涉及RMI协议的地方修改为HTTP协议 | v1.0 |
| 魏源 | 2020.04.24 | 用户界面的分解及模块职责 | v1.0 |
| 徐慧雯 | 2020.04.25 | 业务逻辑层分解 | v1.0 |
| 周杼彦 | 2020.04.25 | 数据层分解 | v1.0 |
| 周杼彦 | 2020.04.25 | 修改了格式错误和排版错误 | v1.1 |
| 汪乐琪 | 2020.04.26 | 增加了目录 | v1.2 |

<a name="767fa455"></a>
## 目录


<a name="e4568847"></a>
## 1.引言


<a name="ca384773"></a>
### 1.1编制目的
本报告详细完成对互联网酒店预定系统的概要设计，达到指导详细设计和开发的目的，同时实现和测试人员及用户的沟通。<br />本报告面向开发人员、测试人员及最终用户而编写，是了解系统的导航。<br />

<a name="5644640f"></a>
### 1.2词汇表
| 词汇名称 | 词汇含义 | 备注 |
| :---: | --- | --- |
| IHBS | Internet Hotel Booking System | 互联网酒店预定系统 |



<a name="35808e79"></a>
### 1.3参考资料
1.互联网酒店预订系统用例文档<br />2.互联网酒店预定系统需求规格说明文档<br />3.软件工程与计算（卷二）软件开发的技术基础<br />

<a name="462b1b38"></a>
## 2.产品概述
参考互联网酒店预订系统用例文档和互联网酒店预定系统软件需求规格说明中对产品的概括描述。<br />

<a name="87e53fda"></a>
## 3.逻辑视图


- 处理静态设计模型
   - （描述并绘制设计方案、逻辑表达）
   - 互联网酒店预定系统（IHBS）中，选择了分层体系结构风格，将系统分为3层（展示层，业务逻辑层，数据层）能够很好地示意整个高层抽象。展示层包括GUI页面的实现，业务逻辑层包含业务逻辑处理的实现，数据层负责数据的持久化和访问，分层体系结构的逻辑视角和逻辑设计方案如下图1，图2所示。
- 示意图
   - （注意：逻辑表达需要更加细化）

![图1 逻辑视角](https://cdn.nlark.com/yuque/0/2020/png/1073219/1587273136632-540a803b-77a1-4632-9f2c-7835ea3e5c8a.png#align=left&display=inline&height=646&margin=%5Bobject%20Object%5D&name=%E5%9B%BE1%20%E9%80%BB%E8%BE%91%E8%A7%86%E8%A7%92&originHeight=646&originWidth=746&size=0&status=done&style=none&width=746) <br /> 
![图二 逻辑视图](https://cdn.nlark.com/yuque/0/2020/png/1073219/1587700035083-67c67932-ac5b-457f-bb6a-24b5b17994ef.png#align=left&display=inline&height=1273&margin=%5Bobject%20Object%5D&name=%E5%9B%BE%E4%BA%8C%20%E9%80%BB%E8%BE%91%E8%A7%86%E5%9B%BE&originHeight=1273&originWidth=1254&size=0&status=done&style=none&width=1254) <br />
<br />
<br />
<br />
<br />

<a name="e4ba5a56"></a>
## 4组合视图


<a name="21fdf784"></a>
### 4.1开发包图
互联网酒店预定系统的最终开发包设计如表1所示<br />
<br />**表1 互联网酒店预定系统的最终开发包设计**

| 开发包 | 依赖的其他开发包 |
| :---: | --- |
| mainui | userui, adminui, couponui, hotelui, orderui, vo |
| adminui | adminblservice, 界面类库包, vo |
| adminblservice |  |
| adminbl | adminblservice, amindataservice, po, vo, |
| admindataservice | po |
| admindata | vo, adminblservice,adminbl |
| couponui | couponblservice, 界面类库包, vo |
| couponblservice |  |
| couponbl | couponblservice,coupondataservice,po,vo |
| coupondataservice | po |
| coupondata | databeseutility, couponblservice,vo |
| hotelui | hotelblservice, 界面类库包，vo |
| hotelblservice |  |
| hotelbl | hotelblservice, orderblservice, userblservice, hoteldataservice, userdataservice, po, vo |
| hoteldataservice | po, vo |
| hoteldata | hotelblservice, databaseutility,po, vo |
| orderui | orderblservice, 界面类库包，vo |
| orderblservice |  |
| orderbl | hotelblservice, orderblservice, userblservice, orderdataservice, po, vo, databaseutility |
| orderdataservice | po, vo, databaseutility |
| orderdata | orderblservice, databaseutility, vo |
| userui | userblservice, 用户界面类包，vo |
| userblservice |  |
| userbl | userblservice, userdataservice, po, vo |
| userdataservice | po |
| userdata | userblservice, databaseutility, po, vo |
| vo |  |
| po |  |
| 界面类库包 |  |
| databaseutility | JDBC |


<br />互联网酒店预定系统客户端开发包图如图3所示，服务器端开发包图如图4所示。<br />
<br />![图三 客户端开发包图](https://cdn.nlark.com/yuque/0/2020/png/1073219/1587700105859-6d98d1ed-5d01-4ac9-acba-df2ecc4a5e06.png#align=left&display=inline&height=818&margin=%5Bobject%20Object%5D&name=%E5%9B%BE%E4%B8%89%20%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%BC%80%E5%8F%91%E5%8C%85%E5%9B%BE&originHeight=1566&originWidth=1428&size=0&status=done&style=none&width=746) <br />
<br />
<br />![图四 服务器端开发包图](https://cdn.nlark.com/yuque/0/2020/png/1073219/1587700120187-9ecd2008-831c-4089-95c8-403df458ed81.png#align=left&display=inline&height=1092&margin=%5Bobject%20Object%5D&name=%E5%9B%BE%E5%9B%9B%20%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E5%BC%80%E5%8F%91%E5%8C%85%E5%9B%BE&originHeight=1092&originWidth=1418&size=0&status=done&style=none&width=1418) <br />
<br />
<br />
<br />

<a name="022184ed"></a>
### 4.2运行时进程


- 表示软件在运行时进程间的交互，描述系统的动态结构
   - 在互联网酒店预订系统中，会有多个客户进程和一个服务端进程，其进程图如图5所示。结合部署图，客户端进程是在客户端机器上运行，服务器端进程在服务器机器上运行。


<br />![图五 进程图](https://cdn.nlark.com/yuque/0/2020/png/1073219/1587700183681-c1c1bd1f-bce4-46a0-8ac8-b978f902a744.png#align=left&display=inline&height=376&margin=%5Bobject%20Object%5D&name=%E5%9B%BE%E4%BA%94%20%E8%BF%9B%E7%A8%8B%E5%9B%BE&originHeight=376&originWidth=437&size=0&status=done&style=none&width=437) <br />
图5 进程图<br />
<br />

<a name="a9f0e0e7"></a>
### 4.3物理部署


- 处理如何将软件组件映射到硬件基础设施
   - 互联网酒店预订系统中服务器端构件是放在服务器端机器上。客户端使用HTTP协议与服务器端进行交互，所以不需要再独立部署。部署图如图6所示。<br />


<br />![](https://cdn.nlark.com/yuque/0/2020/png/1073219/1591255919269-82626d25-188a-44d0-adb8-69a05872ffba.png#align=left&display=inline&height=411&margin=%5Bobject%20Object%5D&name=&originHeight=472&originWidth=740&size=0&status=done&style=none&width=644) <br />
<br />

<a name="9890f816"></a>
## 5.架构设计


- 描述功能分解和如何在不同的层中安排软件模块
   - 描述架构中的对象，包含架构图
   - 描述组件接口信息
      - 包括：语法、前置条件、后置条件



<a name="06aab435"></a>
### 5.1模块职责

- 模块视图

![Alt text](https://cdn.nlark.com/yuque/0/2020/png/1074988/1587708597213-d798718c-a176-4df2-9b52-e9ffb2d261fe.png#align=left&display=inline&height=583&margin=%5Bobject%20Object%5D&name=Alt%20text&originHeight=693&originWidth=880&size=0&status=done&style=none&width=740) <br />图7 模块视图<br />

- 表2 各层职责

| 层 | 职责 |
| --- | --- |
| 用户界面层 | 展示界面 |
| 业务逻辑层 | 对于用户界面输入进行响应并进行业务处理 |
| 数据层 | 存储和提供数据 |



- 表3 层之间调用接口

| 接口 | 服务调用方 | 服务提供方 |
| :---: | --- | --- |
| AdminService<br />CouponMatchStrategy<br />CouponService<br />HotelService<br />RoomService<br />OrderService<br />AccountService | 展示层 | 业务逻辑层 |
| AdminMapper<br />CouponMapper<br />HotelMapper<br />RoomMapper<br />OrderMapper<br />AccountMapper | 业务逻辑层 | 数据层 |



<a name="b75705f2"></a>
### 5.2用户界面层分解
根据需求，系统存在19个用户界面：登录界面、酒店列表界面、酒店细节界面、个人信息界面、个人订单界面、信用充值界面、注册会员界面、酒店管理员界面、添加酒店界面、优惠策略界面、添加优惠策略界面，录入房间界面、订单管理界面、订单填写界面、历史评价界面、历史订单界面、网站管理人员账户管理界面、酒店管理界面、客户信息界面。界面跳转如图所示。
<br />![](https://cdn.nlark.com/yuque/0/2020/png/1074988/1591517251131-40b6ff2f-2111-4377-8bdb-5083cd6fd93c.png#align=left&display=inline&height=854&margin=%5Bobject%20Object%5D&name=&originHeight=854&originWidth=1141&size=0&status=done&style=none&width=1141) <br />
<br />图8 页面界面跳转

<a name="b61f4057"></a>
#### 5.2.1用户界面层模块的职责
如表5所示<br />表5 用户界面层模块职责<br />

| adminui | 负责增、删、改、查用户信息 |
| --- | --- |
| hotelui | 负责显示酒店列表，酒店详细信息的显示，添加酒店页面的显示<br /> |
| orderui | 负责用户订单的显示和新订单填写页面的显示以及订单的撤销 |
| userui | 负责用户登录及注册，用户信息显示和修改，注册会员，以及信用充值 |
| couponui | 负责各个酒店优惠策略的显示，以及优惠策略添加 |

<a name="4IYfa"></a>
#### 5.2.2 用户界面层模块的接口设计
如表6到10所示<br />表6 adminui的接口规范

| **需要的服务（需接口）** |  |  |
| :---: | --- | --- |
| AdminController.addManager | 语法 | public ResponsVO addManager(UserForm userForm) |
|  | 前置条件 | 已经创建一个UserForm对象，并且输入符合规则 |
|  | 后置条件 | 调用adminService的addManager方法 |
| AdminController.getAllManagers | 语法 | public ResponseVO getAllManager() |
|  | 前置条件 | 已经创建有管理员对象 |
|  | 后置条件 | 调用adminService的getAllManagers方法 |
| AdminController.getAllUsers | 语法 | public ResponseVO getAllUsers() |
|  | 前置条件 | 已经创建有客户对象 |
|  | 后置条件 | 调用adminService的getAllUsers方法 |


<br />表7 hotelui的接口规范

|  需要的服务（需接口） |  |  |
| :---: | --- | --- |
| HotelController.retrieveAllHotels | 语法 | public ResponseVO retrieveAllHotels()<br /> |
|  | 前置条件 | 已经有酒店对象 |
|  | 后置条件 | 调用HotelService的retrieveHotels方法<br /> |
| HotelController.retrieveHotelDetail | 语法 | public ResponseVO retrieveHotelDetail(Integer hotelId) |
|  | 前置条件 | 已经有酒店对象，输入为已有酒店对象的id |
|  | 后置条件 | 调用HotelService的retrieveHotelDetails方法 |
| HotelController.addRoomInfo | 语法 | public ResponseVO addRoomInfo(HotelRoom hotelRoom)<br /> |
|  | 前置条件 | 已经有hotelRoom对象且输入符合规范 |
|  | 后置条件 | 调用HotelService的addRoomInfo方法 |
| HotelController.createHotel | 语法 | public ResponseVO createHotel(HotelVO hotelVO) |
|  | 前置条件 | 已经按规定输入了创建酒店所需要的信息 |
|  | 后置条件 | 调用hotelService的createHotel方法 |
| HotelController.updateHotel | 语法 | public ResponseVO updateHotel(hotelVO hotelVO,Integer hotelId) |
|  | 前置条件 | 已经创建了酒店对象，已知酒店编号 |
|  | 后置条件 | 调用hotelService的updateHotel方法 |
| HotelController.getHotelById | 语法 | public ResponseVO getHotelById(Integer hotelId) |
|  | 前置条件 | 已知酒店编号 |
|  | 后置条件 | 调用hotelService的getHotelById方法 |
| HotelController.deleteHotel | 语法 | public ResponseVO deleteHotel(Integer hotelId) |
|  | 前置条件 | 已知酒店编号 |
|  | 后置条件 | 调用hotelService的deleteHotel方法 |
| HotelController.addHotelPicture | 语法 | public ResponseVO getHotelPictures(Integer hotelId) |
|  | 前置条件 | 已知酒店编号 |
|  | 后置条件 | 调用hotelService的getHotelPictures方法 |
| HotelController.getHotelPictures | 语法 | public ResponseVO getHotelPictures(Ineger hotelId) |
|  | 前置条件 | 已知酒店编号 |
|  | 后置条件 | 调用hotelService的getHotelPictures方法 |


<br />表8 orderui的接口规范

| **需要的服务（需接口）** |  |  |
| :---: | --- | --- |
| OrderController.annulOrder | 语法 | public ResponseVO annulOrder(int orderid)<br /> |
|  | 前置条件 | 已知订单编号 |
|  | 后置条件 | 调用orderService的annulOrder |
| OrderController.reserveHotel | 语法 | public ResponseVO reserveHotel(OrderVO orderVO)<br /> |
|  | 前置条件 | 已经创建了订单对象 |
|  | 后置条件 | 调用orderService的reserveHotel |
| OrderController.retrieveUserOrders | 语法 | public ResponseVO retrieveUserOrders(int userid) |
|  | 前置条件 | 已知用户id |
|  | 后置条件 | 调用orderService的retrieveUserOrders |
| OrderController.retrieveAllOrders | 语法 | public ResponseVO retrieveAllOrders() |
|  | 前置条件 | 已经存在订单对象 |
|  | 后置条件 | 调用orderService的retrieveAllOrders |
| OrderController.execOrder | 语法 | public ResponseVO execOrder(int orderid) |
|  | 前置条件 | 已知订单编号 |
|  | 后置条件 | 调用orderService的execOrder |
| OrderController.abnormalOrder | 语法 | public ResponseVO abnormalOrder(int orderid) |
|  | 前置条件 | 已知订单编号 |
|  | 后置条件 | 调用orderService的abnormalOrder |
| OrderController.delayCheckIn | 语法 | public ResponseVO delayCheckIn(int orderid) |
|  | 前置条件 | 已知订单编号 |
|  | 后置条件 | 调用orderService的delayCheckIn |
| OrderController.deleteOrder | 语法 | public ResponseVO deleteOrder(int orderid) |
|  | 前置条件 | 已知订单编号 |
|  | 后置条件 | 调用orderService的deleteOrder |
| OrderController.endOrder | 语法<br /> | public ResponseVO endOrder(int orderid) |
|  | 前置条件 | 已知订单编号 |
|  | 后置条件 | 调用orderService的endOrder |
| OrderController.getOrderById | 语法 | public ReponseVO getOrderById(int orderid) |
|  | 前置条件 | 已知订单编号 |
|  | 后置条件 | 调用orderService的getOrderById |
| OrderController.retrieveHotelOrders | 语法 | public ResponseVO retrieveHotelOrder(Integer hotelId) |
|  | 前置条件 | 已知酒店id |
|  | 后置条件 | 调用orderService的retrieveHotelOrder |

表9 couponui的接口规范

| **需要的服务（需接口）**<br /> |  |  |
| :---: | --- | --- |
| CouponController.getHotelAllCoupons<br /> | 语法 | public ResponseVO getHotelAllCoupons(Integer hotelId)<br /> |
|  | 前置条件 | 已知酒店id |
|  | 后置条件 | 调用couponService的getHotelAllCoupons |
| CouponController.addHotelTargetMoneyCoupon | 语法 | public ResponseVO addHotelTargetMoneyCoupon(HotelTargetMoneyCouponVO hotelTargetMoneyCouponVO)<br /> |
|  | 前置条件 | 已经正确创建优惠策略对象 |
|  | 后置条件 | 调用couponService的addHotelTargetMoneyCoupon |
| CouponController.addHolidayCouponStrategyCoupon | 语法 | public ResponseVO addHolidayCouponStrategyCoupon(HolidayCouponVO holidayCouponVO) |
|  | 前置条件 | 已经正确创建节日特惠对象 |
|  | 后置条件 | 调用couponService的addHolidayCouponStrategyCoupon |
| CouponController.addMultipleRoomsStrategyCoupon | 语法 | public ResponseVO addMultipleRoomsCoupon(MultipleRoomsCouponVO multipleRoomsCouponVO) |
|  | 前置条件 | 已经正确创建了多间满减优惠对象 |
|  | 后置条件 | 调用couponService的addMultipleRoomsCoupon |
| CouponController.getOrderMatchCoupons | 语法 | public ResponseVO getOrderMatchCoupons(Integer userId,Integer hotelId,Double orderPrice,Integer roomNum,String checkIn,String checkOut) |
|  | 前置条件 | 正确输入用户id，酒店id，订单价格，房间数和入住离开时间 |
|  | 后置条件 | 调用couponService的getOrderMatchCoupons |

表10 userui的接口规范

| **需要的服务（需接口）**<br /> |  |  |
| :---: | --- | --- |
| AccountController.login | 语法 | public ResponseVO login(UserForm userForm) |
|  | 前置条件 | 已经创建userForm且符合要求 |
|  | 后置条件 | 调用accountService的login |
| AccountController.registerAccount | 语法 | public ResponseVO registerAccount(UserVO userVO) |
|  | 前置条件 | 已经创建了UserVO且输入符合要求 |
|  | 后置条件 | 调用accountService的registerAccount |
| AccountController.getUserInfo | 语法 | public ResponseVO getUserInfo(int id) |
|  | 前置条件 | 已知用户id |
|  | 后置条件 | 调用accountService的getUserInfo |
| AccountController.updateInfo | 语法 | public ResponseVO updateInfo(UserInfoVO userInfoVO,int id) |
|  | 前置条件 | 用户已有个人信息，已知用户id |
|  | 后置条件 | 调用accountService的updateInfo |
| AccountController.deleteUser | 语法 | public ResponseVO deleteUser(int id) |
|  | 前置条件 | 要删除的用户存在，已知用户id |
|  | 后置条件 | 调用accountService的deleteUser |
| AccountController.updateCredit | 语法 | public ResponseVO updateCredit(int id,double pirce) |
|  | 前置条件 | 已知要更新信用的用户id和充值价格 |
|  | 后置条件 | 调用accountService的updateCredit |
| CommentController.addComment | 语法 | public ResponseVO addComment(CommentVO commentVO) |
|  | 前置条件 | 已经创建了评论 |
|  | 后置条件 | 调用commentService的addComment |
| CommentController.getCommentsByHotelId | 语法 | public ResponseVO getCommentsByHotelId(int hotelId) |
|  | 前置条件 | 要查询的酒店存在，已知酒店id |
|  | 后置条件 | 调用commentService的getCommentsByHotelId |
| CommentController.getCommentByUserId | 语法 | public ReaponseVO getCommentByUserId(int userId) |
|  | 前置条件 | 要查询的用户存在，已知用户id |
|  | 后置条件 | 调用commentService的getCommentByUserId |
| CommentController.countRate | 语法 | public ResponseVO countRate(int hotelId) |
|  | 前置条件 | 要计算的评分的酒店已经存在，已知酒店id |
|  | 后置条件 | 调用commentService的countRate |
| CreditController.retrieveUserCredits | 语法 | public ResponseVO retrieveUserCredits(int id) |
|  | 前置条件 | 用户已经存在，已知用户id |
|  | 后置条件 | 调用creditService的retrieveUserCredits |
| CreditControllder.retrieveAllCredits | 语法 | public ResponseVO retrieveAllCredits(int id) |
|  | 前置条件 | 用户已经存在，已知用户id |
|  | 后置条件 | 调用creditService的retrieveAllCredits |
| CreditController.chargeCredit | 语法 | public ResponseVO chargeCredit(int id,double money) |
|  | 前置条件 | 用户已经存在，已知用户id和充值数 |
|  | 后置条件 | 调用creditService的chargeCredit |
| VIPController.registerVIP | 语法 | public ResponseVO registerVIP(VipVO vipVO) |
|  | 前置条件 | 已经正确创建一个VIP对象 |
|  | 后置条件 | 调用VIPService的registerVIP |
| VIPController.getVIPInfoByUserId | 语法 | public ResponseVO getVIPInfoByUserId(Integer userId) |
|  | 前置条件 | 要查询的用户存在，已知用户的id |
|  | 后置条件 | 调用VIPService的getVIPInfoByUserId |
| VIPController.getVIPInfoByVIPId | 语法 | public ResponseVO getVIPInfoByVIPId(int id) |
|  | 前置条件 | 要查询的VIP存在且已知vipid |
|  | 后置条件 | 调用VIPService的getVIPInfoByVIPId |

<a name="841a81d5"></a>
### 5.3业务逻辑层分解
业务逻辑层包括多个针对界面的业务逻辑处理对象。<br />业务逻辑层的设计如图9所示。<br />![bl层.png](https://cdn.nlark.com/yuque/0/2020/png/1073284/1587779400384-60229ebb-692e-463a-af0b-1166cc16fc8a.png#align=left&display=inline&height=409&margin=%5Bobject%20Object%5D&name=bl%E5%B1%82.png&originHeight=409&originWidth=857&size=5857&status=done&style=none&width=857) <br />图9 业务逻辑层的设计
<a name="b61f4057-1"></a>
#### 5.3.1职责
**表11 业务逻辑层模块的职责**

| **模块** | **职责** |
| :---: | :---: |
| adminbl | 负责实现酒店管理人员账号添加和信息查看界面所需要的服务 |
| couponbl | 负责实现优惠策略界面所需要的服务 |
| hotelbl | 负责实现酒店和客房信息增删改查界面所需要的服务 |
| orderbl | 负责实现订单增删改查界面所需要的服务 |
| userbl | 负责实现用户注册登录信息查看和修改界面所需要的服务 |

<a name="15b0a0a9-1"></a>
#### 5.3.2接口规范
**表12 adminbl模块的接口规范**

| **提供的服务（供接口）** |  |
| :---: | --- |
| <br />AdminService.addManager | 语法：ResponseVO addManager(UserForm userForm); |
|  | 前置条件：userForm符合输入规范 |
|  | 后置条件：数据库中添加一个酒店管理人员的账号 |
| <br />AdminService.getAllManagers | 语法：List<User> getAllManagers(); |
|  | 前置条件：已添加酒店管理人员的账号信息 |
|  | 后置条件：返回所有酒店管理人员的信息 |
| <br />AdminService.getAllUsers | 语法：List<User> getAllUsers(); |
|  | 前置条件：酒店管理员已被授权 |
|  | 后置条件：返回所有用户的信息（不含管理人员） |
| **需要的服务（需接口）** |  |
| 服务名 | 服务 |
| AdminDataService.addManagers | 添加酒店管理员账户 |
| AdminDataService.getAllManagers | 获取所有酒店管理员的信息 |
| AdminDataService.getAllUsers | 获取所有用户信息 |

<br />**<br />**表13 couponbl模块的接口规范**<br />**

| **提供的服务（供接口）** |  |
| :---: | --- |
| <br />CouponService.getMatchCouponOrder | 语法：List<Coupon> getMatchCouponOrder(OrderVO orderVO); |
|  | 前置条件：酒店管理员启动优惠券策略 |
|  | 后置条件：返回某一订单可用的优惠策略列表 |
| <br />CouponService.getHotelAllCoupon | 语法：List<Coupon> getHotelAllCoupon(Integer hotelId); |
|  | 前置条件：hotelId符合输入规范 |
|  | 后置条件：返回目标酒店可用的所有优惠策略列表（包括失效的） |
| <br />CouponService.addCoupon | 语法：CouponVO addCoupon(CouponVO couponVO); |
|  | 前置条件：管理员要添加优惠策略 |
|  | 后置条件：返回新添加的优惠策略 |
| <br />CouponMatchStrategy.isMatch | 语法：boolean isMatch(OrderVO orderVO, Coupon coupon); |
|  | 前置条件：orderVO和coupon格式正确 |
|  | 后置条件：判断orderVO是否和coupon匹配 |
| **需要的服务（需接口）** |  |
| 服务名 | 服务 |
| CouponDataService.insertCoupon | 添加新的优惠策略 |
| Coupon.DataService.selectByHotelID | 返回目标酒店可用的所有优惠策略 |


<br />
<br />表14 hotelbl模块的接口规范

| **提供的服务（供接口）** |  |
| :---: | --- |
| <br />HotelService.addHotel | 语法：void addHotel(HotelVO hotelVO); |
|  | 前置条件：hotelVO不为空且格式正确 |
|  | 后置条件：添加一个酒店的信息 |
| <br />HotelService.updateRoomInfo | 语法：void updateRoomInfo(Integer hotelId, String roomType,Integer rooms); |
|  | 前置条件：hotelId,roomType,rooms不为空且格式正确 |
|  | 后置条件：更新目标酒店目标房型的剩余客房数量 |
| <br />HotelService.updateHotelInfo | 语法：ResponseVO updateHotelInfo(Integer hotelId, String name, Integer phoneNum, String description, String hotelStar); |
|  | 前置条件：酒店已经被录入网站 |
|  | 后置条件：更新目标酒店的相关信息 |
| <br />HotelService.retrieveHotels | 语法：List<HotelVO> retrieveHotels(); |
|  | 前置条件：酒店列表不为空 |
|  | 后置条件：返回列表酒店信息 |
| <br />HotelService.retrieveHotelDetails | 语法：HotelVO retrieveHotelDetails(Integer hotelId); |
|  | 前置条件：hotelId不为空且格式正确 |
|  | 后置条件：返回目标酒店的详细信息 |
| <br />HotelService.getRoomCurNum | 语法：int getRoomCurNum(Integer hotelId,String roomType); |
|  | 前置条件：目标酒店已被录入 |
|  | 后置条件：返回目标酒店剩余某种房间的数量 |
| <br />HotelService.getHotelById | 语法：Hotel getHotelById(Integer hotelId); |
|  | 前置条件：hotelId格式正确 |
|  | 后置条件：返回id值为hotelId的酒店 |
| <br />HotelService.deleteHotel | 语法：ResponseVO deleteHotel(Integer hotelId); |
|  | 前置条件：酒店已存在且hotelId格式正确 |
|  | 后置条件：删除id为hotelId的酒店，并更新数据库 |
| <br />HotelService.updateHotelRate | 语法：void updateHotelRate(Integer hotelId, double rate); |
|  | 前置条件：酒店id已存在且格式正确 |
|  | 后置条件：更新目标酒店的评分 |
| <br />RoomService.retrieveHotelRoomInfo | 语法：List<HotelRoom> retrieveHotelRoomInfo(Integer hotelId); |
|  | 前置条件：hotelId不为空且格式正确 |
|  | 后置条件：返回目标酒店的全部房间信息 |
| <br />RoomService.insertRoomInfo | 语法：void insertRoomInfo(HotelRoom hotelRoom); |
|  | 前置条件：hotelRoom已创建且格式正确 |
|  | 后置条件：添加一个新的客房信息 |
| <br />HotelPictureService.addHotelPicture | 语法：ResponseVO addHotelPicture(PictureVO pictureVO); |
|  | 前置条件：相关图片已存在 |
|  | 后置条件：给酒店添加相关图片 |
| <br />HotelPictureService.getHotelPicture | 语法：List<String> getHotelPictures(Integer hotelId); |
|  | 前置条件：酒店id已存在且格式正确 |
|  | 后置条件：获取目标酒店的图片 |
| **需要的服务（需接口）** |  |
| HotelDataService.insertHotel | 在数据库中添加一个酒店信息 |
| HotelDataService.selectAllHotel | 列表获取所有酒店信息 |
| HotelDataService.selectById | 获取目的ID的酒店信息 |
| HotelDataService.deleteHotel | 删除目的ID的酒店 |
| HotelDataService.updateHotelRate | 更新目的酒店的评分 |
| HotelDataService.updateHotelInfo | 更新目的酒店的信息 |
| HotelPictureService.addPicture | 添加酒店的图片 |
| HotelPictureService.getPictures | 获取目的酒店的图片 |
| RoomDataService.updateRoomInfo | 更新特定ID酒店的剩余客房数量 |
| RoomDataService.insertRoom | 增加一个房间的信息 |
| RoomDataService.selectRoomByHotelId | 获取对应酒店的房间信息 |
| RoomDataService.getRoomCurNum | 获取特定ID酒店中剩余房间的数量 |

**<br />**<br />**表15 orderbl模块的接口规范**

| **提供的服务（供接口）** |  |
| :---: | --- |
| <br />OrderService.addOrder | 语法：ResponseVO addOrder(OrderVO orderVO); |
|  | 前置条件：用户新建了一个订单 |
|  | 后置条件：根据oderVO创建订单，并返回创建结果 |
| <br />OrderService.getAllOrders | 语法：List<Order> getAllOrders(); |
|  | 前置条件：已存在创建的订单 |
|  | 后置条件：返回所有订单信息 |
| <br />OrderService.execOrder | 语法：ResponseVO execOrder(int orderid); |
|  | 前置条件：订单id已存在 |
|  | 后置条件：执行订单，更新相关信息 |
| <br />OrderService.abnormalOrder | 语法：ResponseVO abnormalOrder(int orderid); |
|  | 前置条件：订单id已存在 |
|  | 后置条件：订单设置为异常订单的相关状态更新 |
| <br />OrderService.delayCheckIn | 语法：ResponseVO delayCheckIn(int orderid); |
|  | 前置条件：订单id已存在 |
|  | 后置条件：订单设置为延迟入住的相关状态更新 |
| <br />OderService.annulOrders | 语法：ResponseVO annulOrder(int orderid); |
|  | 前置条件：订单已创建 |
|  | 后置条件：撤销对应的订单并返回撤销订单结果 |
| <br />OrderService.deleteOrder | 语法：ResponseVO deleteOrder(int orderid); |
|  | 前置条件：订单id已存在 |
|  | 后置条件：删除订单并返回删除结果 |
| <br />OrderService.endOrder | 语法：ResponseVO deleteOrder(int orderid); |
|  | 前置条件：目标订单已执行 |
|  | 后置条件：客户退房，订单结束 |
| <br />OrderService.getHotelOrders | 语法：List<Order> getHotelOrders(int hotelId); |
|  | 前置条件：hotelId已创建 |
|  | 后置条件：返回指定酒店的所有订单信息 |
| <br />OrderService.getOrderById | 语法：Order getOrderById(int orderid); |
|  | 前置条件：订单id输入格式正确 |
|  | 后置条件：返回所查询的目标id的订单 |
| <br />OrderService.commentOrder | 语法：void commentOrder(int orderid); |
|  | 前置条件：订单已执行 |
|  | 后置条件：该订单被用户评价 |
| **需要的服务（需接口）** |  |
| OrderDataService.addOrder | 添加一个订单记录 |
| OrderDataService.getAllOrders | 获得所有的订单信息 |
| OrderDataService.getUserOrders | 获得指定用户的所有订单信息 |
| OrderDataService.getHotelOrders | 获得指定酒店的所有订单 |
| OrderDataService.execOrder | 将订单状态修改为已执行 |
| OrderDataService.abnormalOrder | 将订单状态修改为异常订单 |
| OrderDataService.deleteOrder | 删除指定订单 |
| OrderDataService.annulOrder | 撤销目的订单 |
| OrderDataService.delayCheckIn | 将订单状态修改为延迟入住 |
| OrderDataService.endOrder | 将订单状态修改为已完成 |
| OrderDataService.commentOrder | 将订单状态修改为已评价 |
| OrderDataService.getOrderByID | 获得指定订单号的订单的信息 |

**<br />**<br />           表16 userbl模块的接口规范

| **提供的服务（供接口）** |  |
| :---: | --- |
| <br />AccountService.registerAccount | 语法：ResponseVO registerAccount(UserVO userVO); |
|  | 前置条件：userVO不为空且格式正确 |
|  | 后置条件：根据userVO查看是否已经存在对应的账户，若没有，增加一条新的账户；并返回创建结果 |
| <br />AccountService.login | 语法：User getUserInfo(int id); |
|  | 前置条件：userid已存在且格式正确 |
|  | 后置条件：用户登录，登陆成功信息会保存 |
| <br />AccountService.getUserInfo | 语法：User getUserInfo(int id); |
|  | 前置条件：id已创建且格式正确 |
|  | 后置条件：获取特定ID的用户的信息 |
| <br />AccountService.updateUserInfo | 格式：ResponseVO updateUserInfo(int id, String password,String username,String phonenumber); |
|  | 前置条件：userid已创建 |
|  | 后置条件：更新用户个人信息 |
| <br />AccountService.deleteUser | 语法：ResponseVO deleteUser(int id); |
|  | 前置条件：用户id已存在 |
|  | 后置条件：删除用户 |
| <br />AccountService.getCurrentUserCredit | 语法：double getCurrentUserCredit(int id); |
|  | 前置条件：用户id已创建 |
|  | 后置条件：获取用户最新信用值 |
| <br />AccountService.updateCredit | 语法：ResponseVO updateCredit(int id, double change); |
|  | 前置条件：用户id已创建 |
|  | 后置条件：更新用户信用值 |
| <br />CommentService.addComment | 语法：ResponseVO addComment(CommentVO commentVO); |
|  | 前置条件：用户订单已执行结束 |
|  | 后置条件：用户给入住的酒店添加评论 |
| <br />CommentService.getCommentsByHotelId | 语法：List<Comment> getCommentsByHotelId(int hotelId); |
|  | 前置条件：酒店id已创建 |
|  | 后置条件：获取目标酒店的所有评论 |
| <br />CommentService.getCommentsByUserId | 语法：List<Comment> getCommentsByUserId(int userId); |
|  | 前置条件：用户id已创建 |
|  | 后置条件：获取用户所有评论 |
| <br />CommentService.countRate | 语法：double countRate(int hotelId); |
|  | 前置条件：酒店id已创建 |
|  | 后置条件：计算酒店评分 |
| <br />CreditService.getCreditChangeByAction | 语法：double getCreditChangeByAction(String action, double price); |
|  | 前置条件：订单行为符合格式规范 |
|  | 后置条件：获取信用改变值 |
| <br />CreditService.addCreditRecord | 语法：ResponseVO addCreditRecord(int userid, int orderid, String action, double price); |
|  | 前置条件：用户id，订单id已存在，相应输入符合规范 |
|  | 后置条件：向数据库中添加一条用户的信用记录 |
| <br />CreditService.getAllCredits | 语法：List<UserCredit> getAllCredits(); |
|  | 前置条件：数据库中已有信用表 |
|  | 后置条件：获取数据库中全部信用记录 |
| <br />CreditService.getUserCredits | 语法：List<UserCredit> getUserCredits(int id); |
|  | 前置条件：用户id已创建 |
|  | 后置条件：获得指定用户的所有信用记录 |
| <br />CreditService.chargeCredit | 语法：ResponseVO chargeCredit(int id, double money); |
|  | 前置条件：用户id已创建 |
|  | 后置条件：给用户进行信用重新 |
| <br />VIPService.registerVIP | 语法：ResponseVO registerVIP(VipVO vipVO); |
|  | 前置条件：用户id已创建 |
|  | 后置条件：给用户注册VIP身份 |
| <br />VIPService.getVIPInfoByUserId | 语法：VIP getVIPInfoByUserId(Integer userId); |
|  | 前置条件：userid已创建 |
|  | 后置条件：返回该用户的VIP信息 |
| <br />VIPService.getVIPInfoByVIPId | 语法：VIP getVIPInfoByVIPId(Integer id); |
|  | 前置条件：用户已注册VIP |
|  | 后置条件：返回该VIP的信息 |
| **需要的服务（需接口）** |  |
| UserDataService.createNewAccount | 在数据库中创建一个新的账户 |
| UserDataService.getAccountByName | 获取对应账户的信息 |
| UserDataService.getAccountByID | 获取对应账户的信息 |
| UserDataService.updateAccount | 更新对应账户的信息 |
| UserDataService.deleteUser | 删除用户 |
| UserDataService.getCurrentUserCredit | 获取当前用户信用值 |
| UserDataService.updateCredit | 更新当前用户信用值 |
| UserDataService.addComment | 用户给入住酒店添加评论 |
| UserDataService.getCommentByHotelId | 获取当前酒店的评价 |
| UserDataService.getCommentByUserId | 获取当前用户做的所有评价 |
| UserDataService.addCreditRecord | 添加信用记录 |
| UserDataService.getAllCredits | 获取全部信用记录 |
| UserDataService.getUserCredits | 获取用户的所有信用变更记录 |
| UserDataService.registerVIP | 注册会员 |
| UserDataService.getVIPInfoByUserId | 查找目标用户的会员信息 |
| UserDataService.getVIPInfoByVIPId | 查找相应会员的会员信息 |

<a name="urp0U"></a>
### 
<a name="WRkHo"></a>
### 5.4数据层分解
      数据层主要给业务逻辑层提供数据访问服务，包括对于持久化数据的增、删、改、查。例如，业务逻辑模块adminbl需要的服务由adminDataService接口提供。adminDataService接口通过mybatis绑定同名xml文件实现。持久化数据的保存通过mysql数据库的形式。

![](https://cdn.nlark.com/yuque/0/2020/png/997584/1587796614705-43a56281-3fe3-4fef-885c-58e338d3b65b.png#align=left&display=inline&height=666&margin=%5Bobject%20Object%5D&name=&originHeight=666&originWidth=880&size=0&status=done&style=none&width=880)<br />图10 AdminData模块设计图

![](https://cdn.nlark.com/yuque/0/2020/png/997584/1587796668059-9f46e697-bf23-4f27-afe1-bb13ea85087f.png#align=left&display=inline&height=666&margin=%5Bobject%20Object%5D&name=&originHeight=666&originWidth=880&size=0&status=done&style=none&width=880)<br />图11 CouponData模块设计图

![](https://cdn.nlark.com/yuque/0/2020/png/997584/1587796693877-1ac2437f-3503-4cb5-98c7-6c7bc169e367.png#align=left&display=inline&height=666&margin=%5Bobject%20Object%5D&name=&originHeight=666&originWidth=880&size=0&status=done&style=none&width=880)<br />图12 HotelData模块设计图

![](https://cdn.nlark.com/yuque/0/2020/png/997584/1587796720156-fd7f106b-66d0-45e4-a4f3-206d50fb3e47.png#align=left&display=inline&height=666&margin=%5Bobject%20Object%5D&name=&originHeight=666&originWidth=880&size=0&status=done&style=none&width=880)<br />图13 OrderData模块设计图

![](https://cdn.nlark.com/yuque/0/2020/png/997584/1587796754401-e6e68a8c-01f4-48ea-83c2-2fca055803ad.png#align=left&display=inline&height=666&margin=%5Bobject%20Object%5D&name=&originHeight=666&originWidth=1552&size=0&status=done&style=none&width=1552)<br />图14 RoomData模块设计图

![](https://cdn.nlark.com/yuque/0/2020/png/997584/1587796783714-6c9d293a-16cf-43b8-a103-29b3f72d0a7d.png#align=left&display=inline&height=666&margin=%5Bobject%20Object%5D&name=&originHeight=666&originWidth=1765&size=0&status=done&style=none&width=1765)<br />图15 UserData模块设计图<br />

<a name="m03KT"></a>
#### 5.4.1职责



| 模块 | 职责 |
| --- | --- |
| AdminData | 提供管理员数据相关的增加、查找服务 |
| CouponData | 提供优惠券相关的增删改查服务 |
| OrderData | 提供订单相关的增删改查服务 |
| UserData | 提供用户数据的创建、查找、更改服务 |
| HotelData | 提供酒店相关的增加、查找服务 |
| RoomData | 提供房间相关的增加、查找、更改服务 |



<a name="G3BQh"></a>
#### 5.4.2接口规范

<br />**表17 AdminData模块的接口规范**

---

**提供的服务（供接口）**

| AdminDataService.addManager | **语法** | int addManager(User user) |
| :---: | --- | --- |
|  | **前置条件** | 同样的ID的管理员在Mapper中不存在 |
|  | **后置条件** | 在数据库中添加一个po记录 |
| AdminDataService.getAllManagers | **语法** | List<User> getAllManagers() |
|  | **前置条件** | 无 |
|  | **后置条件** | 返回所有管理员的信息 |
| AdminDataService.getAllUsers | **语法** | List<User> getAllUsers() |
|  | **前置条件** | 无 |
|  | **后置条件** | 返回所有用户信息 |


<br />
<br />**表18 CouponData模块的接口规范**

---

**提供的服务（供接口）**

| CouponDataService.insertCoupon | **语法** | int insertCoupon(Coupon coupon) |
| :---: | --- | --- |
|  | **前置条件** | coupon格式正确 |
|  | **后置条件** | 在数据库中添加一个po记录 |
| CouponDataService.selectByHotelID | **语法** | List<Coupon> selectByHotelID(Integer hotelID) |
|  | **前置条件** | 在数据库中存在同样的hotelID的po |
|  | **后置条件** | 返回对应hotel的优惠券信息 |


<br />
<br />**表19 HotelData模块的接口规范**

---

**提供的服务（供接口）**

| HotelDataService.insertHotel | **语法** | int insertHotel(Hotel hotel) |
| :---: | --- | --- |
|  | **前置条件** | 同样的ID的hotel在Mapper中不存在 |
|  | **后置条件** | 在数据库中添加一个po记录 |
| HotelDataService.selectAllHotel | **语法** | List<HotelVO> selectAllHotel() |
|  | **前置条件** | 无 |
|  | **后置条件** | 返回所有酒店的信息 |
| HotelDataService.selectByID | **语法** | HotelVO selectById(@Param("id") Integer id) |
|  | **前置条件** | 在数据库中存在同样的hotelID的po |
|  | **后置条件** | 返回特定id的酒店信息 |
| HotelDataService.getHotelById | **语法** | Hotel getHotelById(@Param("id") Integer id) |
|  | **前置条件** | 在数据库中存在同样的hotelId的po |
|  | **后置条件** | 返回特定id的酒店信息 |
| HotelDataService.deleteHotel | **语法** | int deleteHotel(@Param("id") Integer id) |
|  | **前置条件** | 在数据库中存在同样的hotelID的po |
|  | **后置条件** | 删除特定id的酒店 |
| HotelDataService.updateHotelRate | **语法** | int updateHotelRate(@Param("id") Integer id, @Param("rate") double rate) |
|  | **前置条件** | 在数据库中存在同样的hotelID的po |
|  | **后置条件** | 更新po的信息 |
| HotelDataService.updateHotelInfo | **语法** | int updateHotelInfo(@Param("id") Integer id, @Param("name") String name, @Param("phoneNum") Integer phoneNum, @Param("description") String description, @Param("hotelStar") String hotelStar); |
|  | **前置条件** | 在数据库中存在同样的hotelID的po |
|  | **后置条件** | 更新po的信息 |


<br />
<br />**表20 RoomlData模块的接口规范**

---

**提供的服务（供接口）**

| RoomDataService.updateRoomInfo | **语法** | int updateRoomInfo(@Param("hotelId") Integer hotelId,@Param("roomType") String roomType,@Param("curNum") Integer curNum) |
| :---: | --- | --- |
|  | **前置条件** | 在数据库中存在同样ID的房间的po |
|  | **后置条件** | 更新一个po |
| RoomDataService.insertRoom | **语法** | int insertRoom(HotelRoom hotelRoom) |
|  | **前置条件** | 在数据库中不存在同样ID的房间的po |
|  | **后置条件** | 在数据库中增加一个po信息 |
| RoomDataService.selectRoomsByHotelId | **语法** | List<HotelRoom> selectRoomsByHotelId(@Param("hotelId") Integer hotelId); |
|  | **前置条件** | 在数据库中存在同样的hotelID的po |
|  | **后置条件** | 返回对应酒店的房间信息 |
| RoomDataService.getRoomCurNum | **语法** | int getRoomCurNum(@Param("hotelId") Integer hotelId,@Param("roomType") String roomType) |
|  | **前置条件** | 在数据库中存在同样的hotelID的po |
|  | **后置条件** | 返回酒店剩余房间的数量 |


<br />
<br />**表21 OrderData模块的接口规范**

---

**提供的服务（供接口）**

| OrderDataService.addOrder | **语法** | int addOrder(Order order) |
| :---: | --- | --- |
|  | **前置条件** | 同样的OrderID的po在Mapper中不存在 |
|  | **后置条件** | 在数据库中增加一个po记录 |
| OrderDataService.getAllOrders | **语法** | List<Order> getAllOrders() |
|  | **前置条件** | 无 |
|  | **后置条件** | 返回所有订单信息 |
| OrderDataService.getUsersOrders | **语法** | List<Order> getUserOrders(@Param("userid") int userid) |
|  | **前置条件** | 在数据库中存在同样的userid的po |
|  | **后置条件** | 返回指定用户的订单信息 |
| OrderDataService.annulOrder | **语法** | int annulOrder(@Param("orderid") int orderid) |
|  | **前置条件** | 在数据库中存在同样的orderID的po |
|  | **后置条件** | 撤销对应的订单 |
| OrderDataService.getOrderByID | **语法** | Order getOrderById(@Param("orderid") int orderid) |
|  | **前置条件** | 在数据库中存在同样orderID的po |
|  | **后置条件** | 返回对应订单的信息 |
| OrderDataService.execOrder | **语法** | int execOrder(@Param("orderid") int orderid); |
|  | **前置条件** | 在数据库中存在同样orderId的po |
|  | **后置条件** | 执行对应的订单 |
| OrderDataService.abnormalOrder | **语法** | int abnormalOrder(@Param("orderid") int orderid); |
|  | **前置条件** | 在数据库中存在同样orderId的po |
|  | **后置条件** | 将对应的订单设置为异常订单 |
| OrderDataService.deleteOrder | **语法** | int deleteOrder(@Param("orderid") int orderid); |
|  | **前置条件** | 在数据库中存在同样orderId的po |
|  | **后置条件** | 删除对应的订单 |
| OrderDataService.delayCheckIn | **语法** | int delayCheckIn(@Param("orderid") int orderid); |
|  | **前置条件** | 在数据库中存在同样orderId的po |
|  | **后置条件** | 执行对应的订单 |
| OrderDataService.endOrder | **语法** | int endOrder(@Param("orderid") int orderid); |
|  | **前置条件** | 在数据库中存在同样orderId的po |
|  | **后置条件** | 结束对应的订单 |
| OrderDataService.commentOrder | **语法** | int commentOrder(@Param("orderid") int orderid); |
|  | **前置条件** | 在数据库中存在同样orderId的po |
|  | **后置条件** | 向对应的订单添加评论 |
| OrderDataService.getHotelOrders | **语法** | List<Order> getHotelOrders(@Param("hotelid") int hotelid); |
|  | **前置条件** | 在数据库中存在同样hotelId的po |
|  | **后置条件** | 返回对应酒店的所有订单信息 |


<br />
<br />**表22 UserData模块的接口规范**

---

**提供的服务（供接口）**

| UserDataService.createNewAccount | **语法** | int createNewAccount(User user) |
| :---: | --- | --- |
|  | **前置条件** | 在数据库中存在同样userID的po |
|  | **后置条件** | 在数据库中创建一个新的po |
| UserDataService.getAccountByName | **语法** | User getAccountByName(@Param("email") String email) |
|  | **前置条件** | 在数据库中存在同样email的po |
|  | **后置条件** | 返回对应账户的信息 |
| UserDataService.getAccountByID | **语法** | User getAccountById(@Param("id") int id) |
|  | **前置条件** | 在数据库中存在同样的userID的po |
|  | **后置条件** | 返回对应账户的信息 |
| UserDataService.updateAccount | **语法** | int updateAccount(@Param("id") int id, @Param("password") String password,@Param("userName") String username, @Param("phoneNumber") String phonenumber) |
|  | **前置条件** | 在数据库中存在同样的userID的po |
|  | **后置条件** | 更新一个po |
| UserDataService.deleteUser | **语法** | int deleteUser(@Param("id") int id); |
|  | **前置条件** | 在数据库中存在同样的userID的po |
|  | **后置条件** | 删除用户 |
| UserDataService.getCurrentUserCredit | **语法** | double getCurrentUserCredit(@Param("id") int id); |
|  | **前置条件** | 在数据库中存在同样的userID的po |
|  | **后置条件** | 获取对应账户的当前信用值 |
| UserDataService.updateCredit | **语法** | int updateCredit(@Param("id") int id, @Param("change") double change); |
|  | **前置条件** | 在数据库中存在同样的userID的po |
|  | **后置条件** | 更新一个po |
| UserDataService.addComment | **语法** | int addComment(Comment comment); |
|  | **前置条件** | 用户已退房 |
|  | **后置条件** | 在数据库中增加一个评论信息 |
| UserDataService.getCommentsByHotelId | **语法** | List<Comment> getCommentsByHotelId(@Param("hotelId") int hotelId); |
|  | **前置条件** | 在数据库中存在永阳hotelId的po |
|  | **后置条件** | 返回对应酒店的所有评论信息 |
| UserDataService.getCommentsByUserId | **语法** | List<Comment> getCommentsByUserId(@Param("userId") int userId); |
|  | **前置条件** | 在数据库中存在同样userId的po |
|  | **后置条件** | 返回用户的所有评论信息 |
| UserDataService.addCreditReocrd | **语法** | int addCreditRecord(UserCredit userCredit); |
|  | **前置条件** | 无 |
|  | **后置条件** | 在数据库中增加一条信用记录 |
| UserDataService.getAllCredits | **语法** | List<UserCredit> getAllCredits(); |
|  | **前置条件** | 无 |
|  | **后置条件** | 返回所有信用记录 |
| UserDataService.getUserCredits | **语法** | List<UserCredit> getUserCredits(@Param("id") int id); |
|  | **前置条件** | 在数据库中存在相同userId的po |
|  | **后置条件** | 返回对应用户的所有信用记录 |
| UserDataService.registerVIP | **语法** | int registerVIP(VIP vip); |
|  | **前置条件** | 无 |
|  | **后置条件** | 在数据库中创建一条VIP信息 |
| UserDataService.getVIPInfoByUserId | **语法** | VIP getVIPInfoByUserId(@Param("userId") Integer userId); |
|  | **前置条件** | 在数据库中存在相同userId的po |
|  | **后置条件** | 返回对应用户的会员信息 |


<br />

<a name="cigxm"></a>
## 6.信息视角
<a name="IZCgj"></a>
### 6.1数据持久化对象
系统的po类就是对应的相关的实体类，在此做简单介绍

- CouponPo类包含优惠劵的编号，描述，类型，名称，使用门槛，折扣，优惠金额，可用时间，失效时间，优惠劵状态。
- HotelPo类包含酒店的编号，名称，地址，商圈，星级，评分，详细描述，联系电话。
- HotelRoomPo类包含房间的编号，类型，所属酒店编号，价格，当前剩余可预订房间数，某类型房间总数
- OrderPo类包含订单的编号，客户编号，酒店编号，酒店名称，入住时间，退房时间，房间类型，房间数量，入住人数，是否携带小孩，订单创建时间，订单价格，客户名字，客户电话号码，订单状态。
- UserPo类包含用户编号，邮箱，密码，用户名，电话号码，信用值，用户类型。
- CommentPo类包含评论编号，酒店编号，酒店名，用户编号，订单编号，评论时间，描述相符分值，服务态度分值，卫生环境分值，最终评分，评价内容。
- PicturePo类包含图片编号，酒店编号，图片链接
- UserCredit类包含信用记录编号，变更时间，订单号，用户编号，动作，信用值变化，信用值结果
- VIPPo类包含VIP编号，用户编号，VIP名，VIP种类，用户生日，用户所属企业


<br />持久化用户对象CouponPo的定义如下所示
```java
public class Coupon {
    private int id;
    private String description;
    /**
     * 如果为-1 代表是网站推出的优惠
     */
    private Integer hotelId;
	/**
     * 优惠券类型 1生日特惠 2多间特惠 3满减优惠 4限时优惠
     */
    private Integer couponType;
    /**
     * 优惠券名称
     */
    private String couponName;
    /**
     * 优惠券使用门槛
     */
    private double targetMoney;
    private double discount;
    /**
     * 优惠券优惠金额
     */
    private double discountMoney;
    private LocalDateTime startTime;
    private LocalDateTime endTime;
    /**
     * 优惠券状态 是否已经失效 1可用 0失效
     */
    private Integer status;
    public LocalDateTime getStartTime() { return startTime; }

    public void setStartTime(LocalDateTime startTime) { this.startTime = startTime; }

    public LocalDateTime getEndTime() { return endTime; }

    public void setEndTime(LocalDateTime endTime) { this.endTime = endTime; }

    public int getId() { return id; }

    public void setId(int id) { this.id = id; }
    
    public String getDescription() { return description; }

    public void setDescription(String description) { this.description = description; }

    public String getCouponName() { return couponName; }

    public void setCouponName(String couponName) { this.couponName = couponName; }

    public double getTargetMoney() { return targetMoney;}

    public void setTargetMoney(double targetMoney) {this.targetMoney = targetMoney;}

    public double getDiscountMoney() {return discountMoney;}

    public void setDiscountMoney(double discountMoney) {this.discountMoney = discountMoney;}

    public Integer getHotelId() {return hotelId;}

    public void setHotelId(Integer hotelId) {this.hotelId = hotelId;}

    public Integer getCouponType() {return couponType;}

    public void setCouponType(Integer couponType) {this.couponType = couponType;}

    public Integer getStatus() { return status;}

    public void setStatus(Integer status) {this.status = status;}

    public double getDiscount() {return discount;}

    public void setDiscount(double discount) { this.discount = discount; }

    public Coupon() { }
}
```

<br /> 持久化用户对象HotelPo的定义如下所示
```java
public class Hotel {
    private Integer id;
    private String hotelName;
    private String address;
    /**
    * 商圈
    */
    private BizRegion bizRegion;
    private HotelStar hotelStar;
    private Double rate;
    private String description;
    private String phoneNum;
    /**
    * 酒店管理员id
    */
    private Integer managerId;
    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {this.id = id;}

    public String getHotelName() {return hotelName;}

    public void setHotelName(String hotelName) {this.hotelName = hotelName;}

    public String getAddress() {return address; }

    public void setAddress(String address) {this.address = address;}

    public BizRegion getBizRegion() { return bizRegion;}

    public void setBizRegion(BizRegion bizRegion) { this.bizRegion = bizRegion;}

    public HotelStar getHotelStar() { return hotelStar; }

    public void setHotelStar(HotelStar hotelStar) { this.hotelStar = hotelStar;}

    public Double getRate() {return rate; }

    public void setRate(Double rate) { this.rate = rate; }

    public String getDescription() {return description;}

    public void setDescription(String description) { this.description = description;}

    public String getPhoneNum() { return phoneNum;}

    public void setPhoneNum(String phoneNum) {this.phoneNum = phoneNum; }

    public Integer getManagerId() { return managerId;}

    public void setManagerId(Integer managerId) {this.managerId = managerId; }
}
```

<br />持久化用户对象HotelRoomPo的定义如下所示
```java
public class HotelRoom {
    private Integer id;
    private RoomType roomType;
    private Integer hotelId;
    private double price;
    /**
    * 当前剩余可预定房间数
    */
    private int curNum;
    /**
    * 某类型房间总数
    */
    private int total;
    public Integer getId() {return id; }

    public void setId(Integer id) { this.id = id;}

    public RoomType getRoomType() { return roomType; }

    public void setRoomType(RoomType roomType) { this.roomType = roomType; }

    public Integer getHotelId() { return hotelId; }

    public void setHotelId(Integer hotelId) {this.hotelId = hotelId; }

    public double getPrice() { return price; }

    public void setPrice(double price) {this.price = price; }

    public int getCurNum() {return curNum; }

    public void setCurNum(int curNum) { this.curNum = curNum; }

    public int getTotal() { return total; }

    public void setTotal(int total) {this.total = total;}
}
```

<br />持久化用户对象OrderPo的定义如下所示
```java
public class Order {
    private Integer id;
    private Integer userId;
    private Integer hotelId;
    private String hotelName;
    private String checkInDate;
    private String checkOutDate;
    private String roomType;
    private Integer roomNum;
    private Integer peopleNum;
    private boolean haveChild;
    private String createDate;
    private Double price;
    private String clientName;
    private String phoneNumber;
    private String orderState;

    public Integer getId() {return id;}

    public void setId(Integer id) {this.id = id;}

    public Integer getUserId() {return userId;}

    public void setUserId(Integer userId) {this.userId = userId; }

    public Integer getHotelId() {return hotelId; }

    public void setHotelId(Integer hotelId) { this.hotelId = hotelId;}

    public String getCheckInDate() {return checkInDate; }

    public void setCheckInDate(String checkInDate) { this.checkInDate = checkInDate; }

    public String getCheckOutDate() {return checkOutDate;}

    public void setCheckOutDate(String checkOutDate) {this.checkOutDate = checkOutDate;}

    public String getRoomType() { return roomType; }

    public void setRoomType(String roomType) { this.roomType = roomType; }

    public Integer getRoomNum() { return roomNum; }

    public void setRoomNum(Integer roomNum) {  this.roomNum = roomNum; }

    public Integer getPeopleNum() {   return peopleNum; }

    public void setPeopleNum(Integer peopleNum) { this.peopleNum = peopleNum;  }

    public boolean isHaveChild() { return haveChild; }

    public void setHaveChild(boolean haveChild) { this.haveChild = haveChild; }

    public String getCreateDate() {  return createDate; }

    public void setCreateDate(String createDate) { this.createDate = createDate; }

    public Double getPrice() {  return price; }

    public void setPrice(Double price) { this.price = price; }

    public String getHotelName() {return hotelName; }

    public void setHotelName(String hotelName) {   this.hotelName = hotelName; }

    public String getClientName() { return clientName;  }

    public void setClientName(String clientName) {  this.clientName = clientName;}

    public String getPhoneNumber() {  return phoneNumber; }

    public void setPhoneNumber(String phoneNumber) {  this.phoneNumber = phoneNumber; }

    public String getOrderState() {  return orderState; }

    public void setOrderState(String orderState) { this.orderState = orderState; }
}
```
**<br />
<br />持久化用户对象UserPo的定义如下所示
```java
public class User {    
    private Integer id;    
    private String email;    
    private String password;    
    private String userName;    
    private String phoneNumber;    
    private double credit;    
    private UserType userType;
    
    public Integer getId() { return id;    }    
    
    public void setId(Integer id) { this.id = id;    }   
    
    public String getUserName() {  return userName;    }    
    
    public void setUserName(String userName) {  this.userName = userName;    } 
    
    public String getPhoneNumber() {   return phoneNumber;    }    
    
    public void setPhoneNumber(String phoneNumber) { this.phoneNumber = phoneNumber;    } 
    
    public double getCredit() {  return credit;    } 
    
    public void setCredit(double credit) {  this.credit = credit;    }  
    
    public String getEmail() {  return email;    }    
    
    public void setEmail(String email) { this.email = email;    }  
    
    public String getPassword() {  return password;    }    
    
    public void setPassword(String password) { this.password = password;    } 
    
    public UserType getUserType() { return userType;    }    
    
    public void setUserType(UserType userType) { this.userType = userType;    }
    
}
```

<br />持久化用户对象CommentPo的定义如下所示
```java
public class Comment {

    private int id;//主键id
    private Integer hotelId;
    private String hotelName;
    private Integer userId;
    private Integer orderId;
    private String createDate;
    private double descriptionScore; // 描述相符
    private double serviceScore; // 服务态度
    private double environmentScore; // 环境
    private double finalScore; // 最终评分
    private String userEvaluation;

    public int getId() {
        return id;
    }

    public void setId(int id) {
        this.id = id;
    }

    public Integer getHotelId() {
        return hotelId;
    }

    public void setHotelId(Integer hotelId) {
        this.hotelId = hotelId;
    }

    public String getHotelName() {
        return hotelName;
    }

    public void setHotelName(String hotelName) {
        this.hotelName = hotelName;
    }

    public Integer getUserId() {
        return userId;
    }

    public void setUserId(Integer userId) {
        this.userId = userId;
    }

    public Integer getOrderId() {
        return orderId;
    }

    public void setOrderId(Integer orderId) {
        this.orderId = orderId;
    }

    public String getCreateDate() {
        return createDate;
    }

    public void setCreateDate(String createDate) {
        this.createDate = createDate;
    }

    public double getDescriptionScore() {
        return descriptionScore;
    }

    public void setDescriptionScore(double descriptionScore) {
        this.descriptionScore = descriptionScore;
    }

    public double getServiceScore() {
        return serviceScore;
    }

    public void setServiceScore(double serviceScore) {
        this.serviceScore = serviceScore;
    }

    public double getEnvironmentScore() {
        return environmentScore;
    }

    public void setEnvironmentScore(double environmentScore) {
        this.environmentScore = environmentScore;
    }

    public double getFinalScore() {
        return finalScore;
    }

    public void setFinalScore(double finalScore) {
        this.finalScore = finalScore;
    }


    public String getUserEvaluation() {
        return userEvaluation;
    }

    public void setUserEvaluation(String userEvaluation) {
        this.userEvaluation = userEvaluation;
    }
}
```


持久化用户对象PicturePo的定义如下所示
```java
public class Picture {

    private Integer id;
    private Integer hotelId;
    private String linkStr;

    public Integer getId() { return id; }

    public void setId(Integer id) { this.id = id; }

    public Integer getHotelId() { return hotelId; }

    public void setHotelId(Integer hotelId) { this.hotelId = hotelId; }

    public String getLinkStr() { return linkStr; }

    public void setLinkStr(String linkStr) { this.linkStr = linkStr; }
}
```


持久化用户对象UserCreditPo的定义如下所示
```java
public class UserCredit {

    private Integer id;
    private String createDate;//时间
    private Integer orderId;
    private Integer userId;
    private String actionType;//动作（订单执行、订单异常、订单撤销）
    private double creditChange;//信用度变化
    private double res;//信用度结果

    public Integer getId() { return id; }

    public void setId(Integer id) { this.id = id; }

    public Integer getUserId() { return userId; }

    public void setUserId(Integer userId){this.userId=userId;}

    public String getCreateDate() {
        return createDate;
    }

    public void setCreateDate(String createDate) {
        this.createDate = createDate;
    }

    public Integer getOrderId() { return orderId; }

    public void setOrderId(Integer orderId){this.orderId=orderId;}

    public String getActionType(){return actionType;}

    public void setActionType(String type){this.actionType=type;}

    public double getChange(){return creditChange;}

    public void setChange(double change){this.creditChange=change;}

    public double getRes(){return res;}

    public void setRes(double res){this.res=res;}
}
```


持久化用户对象VIPPo的定义如下所示
```java
public class VIP {

    private Integer id;
    private Integer userId;
    private String vipName;
    private String type;
    private String birthday;
    private String enterpriseName;

    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public Integer getUserId() {
        return userId;
    }

    public void setUserId(Integer userId) {
        this.userId = userId;
    }

    public String getType() {
        return type;
    }

    public void setType(String type) {
        this.type = type;
    }

    public String getBirthday() {
        return birthday;
    }

    public void setBirthday(String birthday) {
        this.birthday = birthday;
    }

    public String getEnterpriseName() {
        return enterpriseName;
    }

    public void setEnterpriseName(String enterpriseName) {
        this.enterpriseName = enterpriseName;
    }

    public String getVipName() { return vipName; }

    public void setVipName(String vipName) {
        this.vipName = vipName;
    }
}
```
<a name="mCvSB"></a>
### 6.2数据库表
数据库表中包含Coupon表, Hotel表, OrderList表, Room表, User表，Comment表，Credit表，PictureList表，VIP表。<br />
<br />
<br />
<br />**<br />
<br />

